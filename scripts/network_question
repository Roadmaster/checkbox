#!/usr/bin/python

import dbus

bus = dbus.SystemBus()
manager_obj = bus.get_object("org.freedesktop.Hal", "/org/freedesktop/Hal/Manager")
manager = dbus.Interface(manager_obj, "org.freedesktop.Hal.Manager")

for device in manager.GetAllDevices():
    device_obj = bus.get_object("org.freedesktop.Hal", device)
    properties = device_obj.GetAllProperties(dbus_interface="org.freedesktop.Hal.Device")
    device_class = properties.get("pci.device_class")
    if device_class and device_class == 2:
        print properties.get("pci.vendor"), properties.get("pci.product")
