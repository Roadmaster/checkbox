plugin: shell
name: wireless/wireless_scanning
user: root
requires: package.name == 'wireless-tools'
command: rfkill unblock wlan wifi; network_wireless_test
_description: Wireless scanning test. It scans and reports on discovered APs.

plugin: manual
name: wireless/wireless_connection
command: network_check
requires: device.category == 'WIRELESS'
_description:
 PURPOSE:
     This test will check your wireless connection.
 STEPS:
     1. Click on the Network icon in the panel.
     2. Select a network below the 'Wireless networks' section.
     3. Click "Test" to verify that it's possible to establish an HTTP connection.
 VERIFICATION:
     Did a notification show and was the connection correctly established?

plugin: shell
name: wireless/wireless_connection_wpa_bg
requires: device.category == 'WIRELESS'
user: root
environ: WPA_BG_SSID WPA_BG_PSK
command: trap "nmcli con delete id $WPA_BG_SSID" EXIT; create_connection $WPA_BG_SSID --security=wpa --key=$WPA_BG_PSK && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
 Tests that the systems wireless hardware can connect to a router using WPA
 security and the 802.11b/g protocols.

plugin: shell
name: wireless/wireless_connection_open_bg
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_BG_SSID
command: trap "nmcli con delete id $OPEN_BG_SSID" EXIT; create_connection $OPEN_BG_SSID && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
 Tests that the systems wireless hardware can connect to a router using no
 security and the 802.11b/g protocols.

plugin: shell
name: wireless/wireless_connection_wpa_n
requires: device.category == 'WIRELESS'
user: root
environ: WPA_N_SSID WPA_N_PSK
command: trap "nmcli con delete id $WPA_N_SSID" EXIT; create_connection $WPA_N_SSID --security=wpa --key=$WPA_N_PSK && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
 Tests that the systems wireless hardware can connect to a router using WPA
 security and the 802.11n protocol.

plugin: shell
name: wireless/wireless_connection_open_n
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_N_SSID
command: trap "nmcli con delete id $OPEN_N_SSID" EXIT; create_connection $OPEN_N_SSID &&  internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
 Tests that the systems wireless hardware can connect to a router using no
 security and the 802.11n protocol.

plugin: shell
name: wireless/monitor_wireless_connection
requires:
 package.name == 'iperf'
 device.category == 'WIRELESS'
user: root
environ: WPA_BG_SSID WPA_BG_PSK SERVER_IPERF
command: trap "nmcli con delete id $WPA_BG_SSID" EXIT; create_connection $WPA_BG_SSID --security=wpa --key=$WPA_BG_PSK && iperf -c $SERVER_IPERF -t 300 -i 30
_description:
 Tests the performance of a systems wireless connection through the iperf tool.

plugin: shell
name: wireless/monitor_wireless_connection_udp
requires:
 package.name == 'iperf'
 device.category == 'WIRELESS'
user: root
environ: WPA_BG_SSID WPA_BG_PSK SERVER_IPERF
command: trap "nmcli con delete id $WPA_BG_SSID" EXIT; create_connection $WPA_BG_SSID --security=wpa --key=$WPA_BG_PSK && iperf -c $SERVER_IPERF -t 300 -i 30 -u -b 100m -p 5050
_description:
 Tests the performance of a systems wireless connection through the iperf tool, using UDP packets.

plugin: shell
name: wireless/basic_802.11a_connection
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_A_SSID
command: trap "nmcli con delete id $OPEN_A_SSID" EXIT; create_connection $OPEN_A_SSID && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
  Test that the system's wireless hardware can connect to a router using the
  802.11a protocol. This requires that you have a router pre-configured to only
  respond to requests on the 802.11a protocol.

plugin: shell
name: wireless/basic_802.11b_connection
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_B_SSID
command: trap "nmcli con delete id $OPEN_B_SSID" EXIT; create_connection $OPEN_B_SSID && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
  Test that the system's wireless hardware can connect to a router using the
  802.11b protocol. This requires that you have a router pre-configured to only
  respond to requests on the 802.11b protocol.

plugin: shell
name: wireless/basic_802.11g_connection
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_G_SSID
command: trap "nmcli con delete id $OPEN_G_SSID" EXIT; create_connection $OPEN_G_SSID && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
  Test that the system's wireless hardware can connect to a router using the
  802.11g protocol. This requires that you have a router pre-configured to only
  respond to requests on the 802.11g protocol.

plugin: shell
name: wireless/basic_802.11n_connection
requires: device.category == 'WIRELESS'
user: root
environ: OPEN_N_SSID
command: trap "nmcli con delete id $OPEN_N_SSID" EXIT; create_connection $OPEN_N_SSID && internet_test --interface=`nmcli dev status | awk '/802-11-wireless/ {print $1}'`
_description:
  Test that the system's wireless hardware can connect to a router using the
  802.11n protocol. This requires that you have a router pre-configured to only
  respond to requests on the 802.11n protocol.
