plugin: attachment
name: acpi_sleep_attachment
command: cat /proc/acpi/sleep

plugin: local
name: bootchart
description: Bootchart information.
requires: package.name == 'bootchart' or package.name == 'pybootchartgui'
user: root
command:
 process_wait -u root bootchart collector ureadahead; \
 [ `ls /var/log/bootchart/*.tgz 2>/dev/null | wc -l` -lt 2 ] && reboot && sleep 100

plugin: local
name: hdparm
requires:
 package.name == 'hdparm'
 device.category == 'DISK'
command:
 cat <<'EOF' | run_templates -t -s 'udev_resource | filter_templates -w "category=DISK"'
 plugin: attachment
 name: hdparm_`ls /sys$path/block`.txt
 requires: device.path == "$path"
 user: root
 command: hdparm -I /dev/`ls /sys$path/block`
 EOF

plugin: attachment
name: bootchart.png
depends: bootchart
requires: (package.name == 'bootchart' and float(lsb.release) < 9.04) or package.name == 'pybootchartgui'
command:
 file=`ls /var/log/bootchart/*.png 2>/dev/null | tail -1`; \
 [ -e "$file" ] && cat "$file"

plugin: attachment
name: bootchart.tgz
depends: bootchart
requires: package.name == 'bootchart' and float(lsb.release) >= 9.04
command:
 file=`ls /var/log/bootchart/*.tgz 2>/dev/null | tail -1`; \
 [ -e "$file" ] && cat "$file"

plugin: attachment
name: installer_bootchart.tgz
command: [ -e /var/log/installer/bootchart.tgz ] && cat /var/log/installer/bootchart.tgz

plugin: attachment
name: installer_debug.gz
command: [ -e /var/log/installer/debug ] && gzip -9 -c /var/log/installer/debug
